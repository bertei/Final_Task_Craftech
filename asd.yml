Minikube-Helm:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Minikube setup
        uses: medyagh/setup-minikube@master
      - name: Helm setup
        uses: azure/setup-helm@v3
        with:
          version: '3.9.0'
      - name: Setup Helm Chart
        run:
          helm upgrade --install nginx-academy ./chart/nginx-academy --values=deploy/scopes/main.yaml --set image.tag=${{ github.run_id }} --timeout "3m0s"
      - name: Sleep for 30 seconds
        uses: jakejarvis/wait-action@master
        with:
            time: '30s'
      - name: List pods
        run: kubectl get po
      - name: Test service URLs
        run: |
          minikube service list
          #minikube service ${{ secrets.SERVICE_CHART_NAME }} --url
          minikube service nginx-academy-chart --url
          echo "------------------opening the service------------------"
          #curl $(minikube service ${{ secrets.SERVICE_CHART_NAME}} --url)
          curl $(minikube service nginx-academy-chart --url)